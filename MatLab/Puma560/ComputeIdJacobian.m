function J = ComputeIdJacobian(q, calibBools, finiteDiff)

if finiteDiff
    J = computeIdJacobianFiniteDiff(q, calibBools);
else
    J = computeIdJacobianClosedForm(q, calibBools);
end

end

function J = computeIdJacobianFiniteDiff(q, calibBools)
    e = zeros(size(calibBools));
    indCalib = find(calibBools);
    
    numMeas = size(q, 1);
    numParams = sum(calibBools);

    J = zeros(3*numMeas, numParams);

    del = 1e-6;

    indLo = 1;

    for iii = 1:numMeas
        indHi = indLo + 2;
        for jjj = 1:numParams
            e1 = e;
            e2 = e;
            e1(indCalib(jjj)) = e1(indCalib(jjj)) - del;
            e2(indCalib(jjj)) = e2(indCalib(jjj)) + del;

            t1 = ComputeForwardKinematics(q(iii,:), e1, false);
            t2 = ComputeForwardKinematics(q(iii,:), e2, false);

            J(indLo:indHi,jjj) = (t2 - t1)./2./del;
        end
        indLo = indLo + 3;
    end

end

function J = computeIdJacobianClosedForm(q, calibBools)
    numMeas = size(q, 1);
    numParams = sum(calibBools);

    J = zeros(3*numMeas, numParams);
    
    indLo = 1;
    
    for iii = 1:numMeas
        indHi = indLo + 2;
        
        q_1 = q(iii,1);
        q_2 = q(iii,2);
        q_3 = q(iii,3);
        q_4 = q(iii,4);
        q_5 = q(iii,5);
        q_6 = q(iii,6);
        
        JTmp = [1, 0, 0,                                                                                                                                   (2159*sin(q_2))/5000 - (4331*cos(q_2)*cos(q_3))/10000 - (203*cos(q_2)*sin(q_3))/10000 - (203*cos(q_3)*sin(q_2))/10000 + (4331*sin(q_2)*sin(q_3))/10000 - (879*cos(q_2)*cos(q_3)*cos(q_5))/5000 + (879*cos(q_5)*sin(q_2)*sin(q_3))/5000 - (879*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5))/5000 - (879*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5))/5000 + 67183/100000, (1501*cos(q_1))/10000 - (2159*cos(q_2)*sin(q_1))/5000 - (203*sin(q_1)*sin(q_2)*sin(q_3))/10000 + (203*cos(q_2)*cos(q_3)*sin(q_1))/10000 - (4331*cos(q_2)*sin(q_1)*sin(q_3))/10000 - (4331*cos(q_3)*sin(q_1)*sin(q_2))/10000 - (879*cos(q_1)*sin(q_4)*sin(q_5))/5000 - (879*cos(q_2)*cos(q_5)*sin(q_1)*sin(q_3))/5000 - (879*cos(q_3)*cos(q_5)*sin(q_1)*sin(q_2))/5000 + (879*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_1)*sin(q_5))/5000 - (879*cos(q_4)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, cos(q_1), 0,  sin(q_1), (1501*cos(q_1))/10000 - (2159*cos(q_2)*sin(q_1))/5000 - (203*sin(q_1)*sin(q_2)*sin(q_3))/10000 + (203*cos(q_2)*cos(q_3)*sin(q_1))/10000 - (4331*cos(q_2)*sin(q_1)*sin(q_3))/10000 - (4331*cos(q_3)*sin(q_1)*sin(q_2))/10000 - (879*cos(q_1)*sin(q_4)*sin(q_5))/5000 - (879*cos(q_2)*cos(q_5)*sin(q_1)*sin(q_3))/5000 - (879*cos(q_3)*cos(q_5)*sin(q_1)*sin(q_2))/5000 + (879*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_1)*sin(q_5))/5000 - (879*cos(q_4)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                             (cos(q_1)*(4331*cos(q_2)*cos(q_3) - 4318*sin(q_2) + 203*cos(q_2)*sin(q_3) + 203*cos(q_3)*sin(q_2) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000, -(sin(q_1)*(4331*cos(q_2)*cos(q_3) - 4318*sin(q_2) + 203*cos(q_2)*sin(q_3) + 203*cos(q_3)*sin(q_2) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000, cos(q_1)*cos(q_2), -cos(q_1)*sin(q_2),  sin(q_1), (203*cos(q_3)*sin(q_1))/10000 - (4331*sin(q_1)*sin(q_3))/10000 - (879*cos(q_5)*sin(q_1)*sin(q_3))/5000 - (879*cos(q_1)*cos(q_2)*sin(q_4)*sin(q_5))/5000 + (879*cos(q_3)*cos(q_4)*sin(q_1)*sin(q_5))/5000,                                      (cos(q_1)*(4331*cos(q_2)*cos(q_3) + 203*cos(q_2)*sin(q_3) + 203*cos(q_3)*sin(q_2) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000, - (4331*cos(q_3)*sin(q_1))/10000 - (203*sin(q_1)*sin(q_3))/10000 - (879*cos(q_3)*cos(q_5)*sin(q_1))/5000 - (879*cos(q_1)*sin(q_2)*sin(q_4)*sin(q_5))/5000 - (879*cos(q_4)*sin(q_1)*sin(q_3)*sin(q_5))/5000, cos(q_2 + q_3)*cos(q_1),  sin(q_1), sin(q_2 + q_3)*cos(q_1),                      (cos(q_1)*(4331*cos(q_2)*cos(q_3) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000, -(879*sin(q_5)*(cos(q_4)*sin(q_1) - cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4) + cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4)))/5000, - (4331*sin(q_1))/10000 - (879*cos(q_5)*sin(q_1))/5000 - (879*cos(q_1)*cos(q_2)*sin(q_3)*sin(q_4)*sin(q_5))/5000 - (879*cos(q_1)*cos(q_3)*sin(q_2)*sin(q_4)*sin(q_5))/5000, sin(q_1)*sin(q_4) + cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4) - cos(q_1)*cos(q_4)*sin(q_2)*sin(q_3), sin(q_2 + q_3)*cos(q_1), cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4) - cos(q_4)*sin(q_1) - cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4), -(879*sin(q_5)*(cos(q_4)*sin(q_1) - cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4) + cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4)))/5000, (879*cos(q_1)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_3))/5000 - (879*cos(q_1)*cos(q_2)*sin(q_3)*sin(q_5))/5000 - (879*cos(q_1)*cos(q_3)*sin(q_2)*sin(q_5))/5000 - (879*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5))/5000 - (879*cos(q_5)*sin(q_1)*sin(q_4))/5000, -(879*cos(q_5)*(cos(q_4)*sin(q_1) - cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4) + cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4)))/5000, cos(q_5)*sin(q_1)*sin(q_4) + cos(q_1)*cos(q_2)*sin(q_3)*sin(q_5) + cos(q_1)*cos(q_3)*sin(q_2)*sin(q_5) + cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5) - cos(q_1)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_3), cos(q_4)*sin(q_1) - cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4) + cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4), cos(q_1)*cos(q_2)*cos(q_5)*sin(q_3) - sin(q_1)*sin(q_4)*sin(q_5) + cos(q_1)*cos(q_3)*cos(q_5)*sin(q_2) - cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5) + cos(q_1)*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5), (879*cos(q_5)*sin(q_1)*sin(q_4))/5000 + (879*cos(q_1)*cos(q_2)*sin(q_3)*sin(q_5))/5000 + (879*cos(q_1)*cos(q_3)*sin(q_2)*sin(q_5))/5000 + (879*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5))/5000 - (879*cos(q_1)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_3))/5000, 0, (879*cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4))/5000 - (879*cos(q_4)*sin(q_1))/5000 - (879*cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4))/5000, cos(q_4)*sin(q_1)*sin(q_6) + cos(q_5)*cos(q_6)*sin(q_1)*sin(q_4) - cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4)*sin(q_6) + cos(q_1)*cos(q_2)*cos(q_6)*sin(q_3)*sin(q_5) + cos(q_1)*cos(q_3)*cos(q_6)*sin(q_2)*sin(q_5) + cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4)*sin(q_6) + cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*cos(q_6) - cos(q_1)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_2)*sin(q_3), cos(q_4)*cos(q_6)*sin(q_1) - cos(q_5)*sin(q_1)*sin(q_4)*sin(q_6) - cos(q_1)*cos(q_2)*cos(q_3)*cos(q_6)*sin(q_4) + cos(q_1)*cos(q_6)*sin(q_2)*sin(q_3)*sin(q_4) - cos(q_1)*cos(q_2)*sin(q_3)*sin(q_5)*sin(q_6) - cos(q_1)*cos(q_3)*sin(q_2)*sin(q_5)*sin(q_6) - cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_6) + cos(q_1)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_3)*sin(q_6), cos(q_1)*cos(q_2)*cos(q_5)*sin(q_3) - sin(q_1)*sin(q_4)*sin(q_5) + cos(q_1)*cos(q_3)*cos(q_5)*sin(q_2) - cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5) + cos(q_1)*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5), (3*cos(q_4)*sin(q_1)*sin(q_6))/25 + (3*cos(q_5)*cos(q_6)*sin(q_1)*sin(q_4))/25 - (3*cos(q_1)*cos(q_2)*cos(q_3)*sin(q_4)*sin(q_6))/25 + (3*cos(q_1)*cos(q_2)*cos(q_6)*sin(q_3)*sin(q_5))/25 + (3*cos(q_1)*cos(q_3)*cos(q_6)*sin(q_2)*sin(q_5))/25 + (3*cos(q_1)*sin(q_2)*sin(q_3)*sin(q_4)*sin(q_6))/25 + (3*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*cos(q_6))/25 - (3*cos(q_1)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_2)*sin(q_3))/25, 0, (3*cos(q_5)*sin(q_1)*sin(q_4)*sin(q_6))/25 - (3*cos(q_4)*cos(q_6)*sin(q_1))/25 + (3*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_6)*sin(q_4))/25 - (3*cos(q_1)*cos(q_6)*sin(q_2)*sin(q_3)*sin(q_4))/25 + (3*cos(q_1)*cos(q_2)*sin(q_3)*sin(q_5)*sin(q_6))/25 + (3*cos(q_1)*cos(q_3)*sin(q_2)*sin(q_5)*sin(q_6))/25 + (3*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_6))/25 - (3*cos(q_1)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_3)*sin(q_6))/25
                0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, (1501*sin(q_1))/10000 + (2159*cos(q_1)*cos(q_2))/5000 - (879*sin(q_1)*sin(q_4)*sin(q_5))/5000 - (203*cos(q_1)*cos(q_2)*cos(q_3))/10000 + (4331*cos(q_1)*cos(q_2)*sin(q_3))/10000 + (4331*cos(q_1)*cos(q_3)*sin(q_2))/10000 + (203*cos(q_1)*sin(q_2)*sin(q_3))/10000 + (879*cos(q_1)*cos(q_2)*cos(q_5)*sin(q_3))/5000 + (879*cos(q_1)*cos(q_3)*cos(q_5)*sin(q_2))/5000 - (879*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5))/5000 + (879*cos(q_1)*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                                                                                                                   (4331*cos(q_2)*cos(q_3))/10000 - (2159*sin(q_2))/5000 + (203*cos(q_2)*sin(q_3))/10000 + (203*cos(q_3)*sin(q_2))/10000 - (4331*sin(q_2)*sin(q_3))/10000 + (879*cos(q_2)*cos(q_3)*cos(q_5))/5000 - (879*cos(q_5)*sin(q_2)*sin(q_3))/5000 + (879*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5))/5000 + (879*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5))/5000 - 67183/100000, sin(q_1), 0, -cos(q_1), (1501*sin(q_1))/10000 + (2159*cos(q_1)*cos(q_2))/5000 - (879*sin(q_1)*sin(q_4)*sin(q_5))/5000 - (203*cos(q_1)*cos(q_2)*cos(q_3))/10000 + (4331*cos(q_1)*cos(q_2)*sin(q_3))/10000 + (4331*cos(q_1)*cos(q_3)*sin(q_2))/10000 + (203*cos(q_1)*sin(q_2)*sin(q_3))/10000 + (879*cos(q_1)*cos(q_2)*cos(q_5)*sin(q_3))/5000 + (879*cos(q_1)*cos(q_3)*cos(q_5)*sin(q_2))/5000 - (879*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5))/5000 + (879*cos(q_1)*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                             (sin(q_1)*(4331*cos(q_2)*cos(q_3) - 4318*sin(q_2) + 203*cos(q_2)*sin(q_3) + 203*cos(q_3)*sin(q_2) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000,  (cos(q_1)*(4331*cos(q_2)*cos(q_3) - 4318*sin(q_2) + 203*cos(q_2)*sin(q_3) + 203*cos(q_3)*sin(q_2) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000, cos(q_2)*sin(q_1), -sin(q_1)*sin(q_2), -cos(q_1), (4331*cos(q_1)*sin(q_3))/10000 - (203*cos(q_1)*cos(q_3))/10000 + (879*cos(q_1)*cos(q_5)*sin(q_3))/5000 - (879*cos(q_1)*cos(q_3)*cos(q_4)*sin(q_5))/5000 - (879*cos(q_2)*sin(q_1)*sin(q_4)*sin(q_5))/5000,                                      (sin(q_1)*(4331*cos(q_2)*cos(q_3) + 203*cos(q_2)*sin(q_3) + 203*cos(q_3)*sin(q_2) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000,   (4331*cos(q_1)*cos(q_3))/10000 + (203*cos(q_1)*sin(q_3))/10000 + (879*cos(q_1)*cos(q_3)*cos(q_5))/5000 + (879*cos(q_1)*cos(q_4)*sin(q_3)*sin(q_5))/5000 - (879*sin(q_1)*sin(q_2)*sin(q_4)*sin(q_5))/5000, cos(q_2 + q_3)*sin(q_1), -cos(q_1), sin(q_2 + q_3)*sin(q_1),                      (sin(q_1)*(4331*cos(q_2)*cos(q_3) - 4331*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_3)*cos(q_5) - 1758*cos(q_5)*sin(q_2)*sin(q_3) + 1758*cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) + 1758*cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5)))/10000,  (879*sin(q_5)*(cos(q_1)*cos(q_4) + cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4) - sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4)))/5000,   (4331*cos(q_1))/10000 + (879*cos(q_1)*cos(q_5))/5000 - (879*cos(q_2)*sin(q_1)*sin(q_3)*sin(q_4)*sin(q_5))/5000 - (879*cos(q_3)*sin(q_1)*sin(q_2)*sin(q_4)*sin(q_5))/5000, cos(q_2)*cos(q_3)*cos(q_4)*sin(q_1) - cos(q_1)*sin(q_4) - cos(q_4)*sin(q_1)*sin(q_2)*sin(q_3), sin(q_2 + q_3)*sin(q_1), cos(q_1)*cos(q_4) + cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4) - sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4),  (879*sin(q_5)*(cos(q_1)*cos(q_4) + cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4) - sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4)))/5000, (879*cos(q_1)*cos(q_5)*sin(q_4))/5000 - (879*cos(q_2)*sin(q_1)*sin(q_3)*sin(q_5))/5000 - (879*cos(q_3)*sin(q_1)*sin(q_2)*sin(q_5))/5000 - (879*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_1))/5000 + (879*cos(q_4)*cos(q_5)*sin(q_1)*sin(q_2)*sin(q_3))/5000,  (879*cos(q_5)*(cos(q_1)*cos(q_4) + cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4) - sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4)))/5000, cos(q_2)*sin(q_1)*sin(q_3)*sin(q_5) - cos(q_1)*cos(q_5)*sin(q_4) + cos(q_3)*sin(q_1)*sin(q_2)*sin(q_5) + cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_1) - cos(q_4)*cos(q_5)*sin(q_1)*sin(q_2)*sin(q_3), sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4) - cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4) - cos(q_1)*cos(q_4), cos(q_1)*sin(q_4)*sin(q_5) + cos(q_2)*cos(q_5)*sin(q_1)*sin(q_3) + cos(q_3)*cos(q_5)*sin(q_1)*sin(q_2) - cos(q_2)*cos(q_3)*cos(q_4)*sin(q_1)*sin(q_5) + cos(q_4)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_5), (879*cos(q_2)*sin(q_1)*sin(q_3)*sin(q_5))/5000 - (879*cos(q_1)*cos(q_5)*sin(q_4))/5000 + (879*cos(q_3)*sin(q_1)*sin(q_2)*sin(q_5))/5000 + (879*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_1))/5000 - (879*cos(q_4)*cos(q_5)*sin(q_1)*sin(q_2)*sin(q_3))/5000, 0, (879*cos(q_1)*cos(q_4))/5000 + (879*cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4))/5000 - (879*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4))/5000, cos(q_2)*cos(q_6)*sin(q_1)*sin(q_3)*sin(q_5) - cos(q_1)*cos(q_5)*cos(q_6)*sin(q_4) - cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4)*sin(q_6) - cos(q_1)*cos(q_4)*sin(q_6) + cos(q_3)*cos(q_6)*sin(q_1)*sin(q_2)*sin(q_5) + sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4)*sin(q_6) + cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_1) - cos(q_4)*cos(q_5)*cos(q_6)*sin(q_1)*sin(q_2)*sin(q_3), cos(q_1)*cos(q_5)*sin(q_4)*sin(q_6) - cos(q_1)*cos(q_4)*cos(q_6) - cos(q_2)*cos(q_3)*cos(q_6)*sin(q_1)*sin(q_4) + cos(q_6)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4) - cos(q_2)*sin(q_1)*sin(q_3)*sin(q_5)*sin(q_6) - cos(q_3)*sin(q_1)*sin(q_2)*sin(q_5)*sin(q_6) - cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_1)*sin(q_6) + cos(q_4)*cos(q_5)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_6), cos(q_1)*sin(q_4)*sin(q_5) + cos(q_2)*cos(q_5)*sin(q_1)*sin(q_3) + cos(q_3)*cos(q_5)*sin(q_1)*sin(q_2) - cos(q_2)*cos(q_3)*cos(q_4)*sin(q_1)*sin(q_5) + cos(q_4)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_5), (3*cos(q_2)*cos(q_6)*sin(q_1)*sin(q_3)*sin(q_5))/25 - (3*cos(q_1)*cos(q_5)*cos(q_6)*sin(q_4))/25 - (3*cos(q_2)*cos(q_3)*sin(q_1)*sin(q_4)*sin(q_6))/25 - (3*cos(q_1)*cos(q_4)*sin(q_6))/25 + (3*cos(q_3)*cos(q_6)*sin(q_1)*sin(q_2)*sin(q_5))/25 + (3*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4)*sin(q_6))/25 + (3*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_1))/25 - (3*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_1)*sin(q_2)*sin(q_3))/25, 0, (3*cos(q_1)*cos(q_4)*cos(q_6))/25 - (3*cos(q_1)*cos(q_5)*sin(q_4)*sin(q_6))/25 + (3*cos(q_2)*cos(q_3)*cos(q_6)*sin(q_1)*sin(q_4))/25 - (3*cos(q_6)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_4))/25 + (3*cos(q_2)*sin(q_1)*sin(q_3)*sin(q_5)*sin(q_6))/25 + (3*cos(q_3)*sin(q_1)*sin(q_2)*sin(q_5)*sin(q_6))/25 + (3*cos(q_2)*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_1)*sin(q_6))/25 - (3*cos(q_4)*cos(q_5)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_6))/25
                0, 0, 1, (879*sin(q_1)*sin(q_4)*sin(q_5))/5000 - (2159*cos(q_1)*cos(q_2))/5000 - (1501*sin(q_1))/10000 + (203*cos(q_1)*cos(q_2)*cos(q_3))/10000 - (4331*cos(q_1)*cos(q_2)*sin(q_3))/10000 - (4331*cos(q_1)*cos(q_3)*sin(q_2))/10000 - (203*cos(q_1)*sin(q_2)*sin(q_3))/10000 - (879*cos(q_1)*cos(q_2)*cos(q_5)*sin(q_3))/5000 - (879*cos(q_1)*cos(q_3)*cos(q_5)*sin(q_2))/5000 + (879*cos(q_1)*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5))/5000 - (879*cos(q_1)*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, (2159*cos(q_2)*sin(q_1))/5000 - (1501*cos(q_1))/10000 + (203*sin(q_1)*sin(q_2)*sin(q_3))/10000 - (203*cos(q_2)*cos(q_3)*sin(q_1))/10000 + (4331*cos(q_2)*sin(q_1)*sin(q_3))/10000 + (4331*cos(q_3)*sin(q_1)*sin(q_2))/10000 + (879*cos(q_1)*sin(q_4)*sin(q_5))/5000 + (879*cos(q_2)*cos(q_5)*sin(q_1)*sin(q_3))/5000 + (879*cos(q_3)*cos(q_5)*sin(q_1)*sin(q_2))/5000 - (879*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_1)*sin(q_5))/5000 + (879*cos(q_4)*sin(q_1)*sin(q_2)*sin(q_3)*sin(q_5))/5000,        0, 1,         0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0, (2159*cos(q_2))/5000 - (203*cos(q_2)*cos(q_3))/10000 + (4331*cos(q_2)*sin(q_3))/10000 + (4331*cos(q_3)*sin(q_2))/10000 + (203*sin(q_2)*sin(q_3))/10000 + (879*cos(q_2)*cos(q_5)*sin(q_3))/5000 + (879*cos(q_3)*cos(q_5)*sin(q_2))/5000 - (879*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5))/5000 + (879*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                                                                                                                                                                                                                                     (879*sin(q_4)*sin(q_5))/5000 - 1501/10000,          sin(q_2),           cos(q_2),         0,                                                                                                                                                                   -(879*sin(q_2)*sin(q_4)*sin(q_5))/5000, (4331*cos(q_2)*sin(q_3))/10000 - (203*cos(q_2)*cos(q_3))/10000 + (4331*cos(q_3)*sin(q_2))/10000 + (203*sin(q_2)*sin(q_3))/10000 + (879*cos(q_2)*cos(q_5)*sin(q_3))/5000 + (879*cos(q_3)*cos(q_5)*sin(q_2))/5000 - (879*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5))/5000 + (879*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                                                                                                                                                      (879*cos(q_2)*sin(q_4)*sin(q_5))/5000,          sin(q_2 + q_3),         0,         -cos(q_2 + q_3), (4331*cos(q_2)*sin(q_3))/10000 + (4331*cos(q_3)*sin(q_2))/10000 + (879*cos(q_2)*cos(q_5)*sin(q_3))/5000 + (879*cos(q_3)*cos(q_5)*sin(q_2))/5000 - (879*cos(q_2)*cos(q_3)*cos(q_4)*sin(q_5))/5000 + (879*cos(q_4)*sin(q_2)*sin(q_3)*sin(q_5))/5000,                                                                          (879*sin(q_2 + q_3)*sin(q_4)*sin(q_5))/5000,                                                                                                                                (879*cos(q_2 + q_3)*sin(q_4)*sin(q_5))/5000,                                                                       sin(q_2 + q_3)*cos(q_4),         -cos(q_2 + q_3),                                                                       sin(q_2 + q_3)*sin(q_4),                                                                          (879*sin(q_2 + q_3)*sin(q_4)*sin(q_5))/5000,                                                                             (879*cos(q_2)*cos(q_3)*sin(q_5))/5000 - (879*sin(q_2)*sin(q_3)*sin(q_5))/5000 - (879*cos(q_2)*cos(q_4)*cos(q_5)*sin(q_3))/5000 - (879*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_2))/5000,                                                                          (879*sin(q_2 + q_3)*cos(q_5)*sin(q_4))/5000,                                                                  sin(q_2)*sin(q_3)*sin(q_5) - cos(q_2)*cos(q_3)*sin(q_5) + cos(q_2)*cos(q_4)*cos(q_5)*sin(q_3) + cos(q_3)*cos(q_4)*cos(q_5)*sin(q_2),                                                                      -sin(q_2 + q_3)*sin(q_4),                                                                  cos(q_5)*sin(q_2)*sin(q_3) - cos(q_2)*cos(q_3)*cos(q_5) - cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) - cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5),                                                                             (879*sin(q_2)*sin(q_3)*sin(q_5))/5000 - (879*cos(q_2)*cos(q_3)*sin(q_5))/5000 + (879*cos(q_2)*cos(q_4)*cos(q_5)*sin(q_3))/5000 + (879*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_2))/5000, 0,                                                                                             (879*sin(q_2 + q_3)*sin(q_4))/5000,                                                                                                                          cos(q_6)*sin(q_2)*sin(q_3)*sin(q_5) - cos(q_2)*sin(q_3)*sin(q_4)*sin(q_6) - cos(q_3)*sin(q_2)*sin(q_4)*sin(q_6) - cos(q_2)*cos(q_3)*cos(q_6)*sin(q_5) + cos(q_2)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_3) + cos(q_3)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_2),                                                                                                                          cos(q_2)*cos(q_3)*sin(q_5)*sin(q_6) - cos(q_3)*cos(q_6)*sin(q_2)*sin(q_4) - cos(q_2)*cos(q_6)*sin(q_3)*sin(q_4) - sin(q_2)*sin(q_3)*sin(q_5)*sin(q_6) - cos(q_2)*cos(q_4)*cos(q_5)*sin(q_3)*sin(q_6) - cos(q_3)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_6),                                                                  cos(q_5)*sin(q_2)*sin(q_3) - cos(q_2)*cos(q_3)*cos(q_5) - cos(q_2)*cos(q_4)*sin(q_3)*sin(q_5) - cos(q_3)*cos(q_4)*sin(q_2)*sin(q_5),                                                                                                                                        (3*cos(q_6)*sin(q_2)*sin(q_3)*sin(q_5))/25 - (3*cos(q_2)*sin(q_3)*sin(q_4)*sin(q_6))/25 - (3*cos(q_3)*sin(q_2)*sin(q_4)*sin(q_6))/25 - (3*cos(q_2)*cos(q_3)*cos(q_6)*sin(q_5))/25 + (3*cos(q_2)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_3))/25 + (3*cos(q_3)*cos(q_4)*cos(q_5)*cos(q_6)*sin(q_2))/25, 0,                                                                                                                                        (3*cos(q_2)*cos(q_6)*sin(q_3)*sin(q_4))/25 + (3*cos(q_3)*cos(q_6)*sin(q_2)*sin(q_4))/25 - (3*cos(q_2)*cos(q_3)*sin(q_5)*sin(q_6))/25 + (3*sin(q_2)*sin(q_3)*sin(q_5)*sin(q_6))/25 + (3*cos(q_2)*cos(q_4)*cos(q_5)*sin(q_3)*sin(q_6))/25 + (3*cos(q_3)*cos(q_4)*cos(q_5)*sin(q_2)*sin(q_6))/25];
        
        J(indLo:indHi,:) = JTmp(:,calibBools);
        indLo = indLo + 3;
    end
end